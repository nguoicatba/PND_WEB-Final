@model PND_WEB.ViewModels.QuotationsEditDeleteDetailController

@{
    Layout = null; // Khuyến nghị để PDF không bị ảnh hưởng bởi layout ngoài

    bool isReadOnly = Model.Quotation.Qsatus == "Hoàn thành" || Model.Quotation.Qsatus == "Đã hủy";
    float totalAmount = 0f;
}

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Export PDF - Báo giá</title>
    <style>
        body { font-family: Arial; font-size: 12px; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { border: 1px solid #000; padding: 5px; text-align: left; }
        th { background-color: #f2f2f2; }
        h1, h3 { margin-bottom: 5px; }
    </style>
</head>
<body>

    <h1>Chi tiết báo giá</h1>

    <table>
        <tr><th>Mã báo giá</th><td>@Model.Quotation.QuotationId</td></tr>
        <tr><th>Trạng thái</th><td>@Model.Quotation.Qsatus</td></tr>
        <tr><th>Nhân viên</th><td>@Model.Quotation.StaffName</td></tr>
        <tr><th>Khách hàng</th><td>@Model.Quotation.CusTo</td></tr>
        <tr><th>Liên hệ khách</th><td>@Model.Quotation.CusContact</td></tr>
        <tr><th>Ngày tạo</th><td>@Model.Quotation.Qdate?.ToString("dd/MM/yyyy")</td></tr>
        <tr><th>Hiệu lực</th><td>@Model.Quotation.Valid?.ToString("dd/MM/yyyy")</td></tr>
        <tr><th>Điều khoản</th><td>@Model.Quotation.Term</td></tr>
        <tr><th>Hàng hóa</th><td>@Model.Quotation.Commodity</td></tr>
        <tr><th>Khối lượng</th><td>@Model.Quotation.Vol</td></tr>
        <tr><th>Điểm đi (POL)</th><td>@Model.Quotation.Pol</td></tr>
        <tr><th>Điểm đến (POD)</th><td>@Model.Quotation.Pod</td></tr>
    </table>

    <h3>Chi tiết chi phí</h3>

    <table>
        <thead>
            <tr>
                <th>Tên phí</th>
                <th>Số lượng</th>
                <th>Đơn vị</th>
                <th>Đơn giá</th>
                <th>Tiền tệ</th>
                <th>Ghi chú</th>
                <th>Thành tiền</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model.QuotationsCharges)
            {
                float rate = item.Rate.HasValue ? (float)item.Rate.Value : 0f;
                float quantity = (float)item.Quantity;
                float amount = quantity * rate;
                totalAmount += amount;

                <tr>
                    <td>@item.ChargeName</td>
                    <td>@item.Quantity</td>
                    <td>@item.Unit</td>
                    <td>@item.Rate?.ToString("N2")</td>
                    <td>@item.Currency</td>
                    <td>@item.Notes</td>
                    <td>@amount.ToString("N2")</td>
                </tr>
            }
        </tbody>
        <tfoot>
            <tr>
                <td colspan="6" style="text-align:right;"><strong>Tổng cộng:</strong></td>
                <td><strong>@totalAmount.ToString("N2")</strong></td>
            </tr>
        </tfoot>
    </table>

</body>
</html>
